<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="msapplication-config" content="/images/site.webmanifest">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"hide","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideRightIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Gradle Dependency ManagementIf you are using single module architecture in your project, there’s no problem. But multi-module Android projects are the primary way to develop an Android App now, and i">
<meta property="og:type" content="article">
<meta property="og:title" content="Gradle dependency management">
<meta property="og:url" content="http://yoursite.com/2022/01/17/Gradle-dependency-management/index.html">
<meta property="og:site_name" content="舊金山周記">
<meta property="og:description" content="Gradle Dependency ManagementIf you are using single module architecture in your project, there’s no problem. But multi-module Android projects are the primary way to develop an Android App now, and i">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/c/cb/Gradle_logo.png">
<meta property="article:published_time" content="2022-01-17T16:12:35.000Z">
<meta property="article:modified_time" content="2022-01-19T02:56:12.774Z">
<meta property="article:author" content="Chauyan">
<meta property="article:tag" content="Gradle Dependency">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://upload.wikimedia.org/wikipedia/commons/c/cb/Gradle_logo.png">

<link rel="canonical" href="http://yoursite.com/2022/01/17/Gradle-dependency-management/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Gradle dependency management | 舊金山周記</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-149656006-1"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-149656006-1');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

  
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">舊金山周記</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">The Venture of San Francisco</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>Tags<span class="badge">102</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="th fa-fw"></i>Categories<span class="badge">11</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>Archives<span class="badge">67</span></a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/01/17/Gradle-dependency-management/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chauyan">
      <meta itemprop="description" content="Personal dev blog for sharing what I've learned.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="舊金山周記">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Gradle dependency management
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-01-17 08:12:35" itemprop="dateCreated datePublished" datetime="2022-01-17T08:12:35-08:00">2022-01-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-01-18 18:56:12" itemprop="dateModified" datetime="2022-01-18T18:56:12-08:00">2022-01-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android-Dev/" itemprop="url" rel="index"><span itemprop="name">Android Dev</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2022/01/17/Gradle-dependency-management/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2022/01/17/Gradle-dependency-management/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><img src="https://upload.wikimedia.org/wikipedia/commons/c/cb/Gradle_logo.png" alt="gradle logo"></p>
<h3 id="Gradle-Dependency-Management"><a href="#Gradle-Dependency-Management" class="headerlink" title="Gradle Dependency Management"></a>Gradle Dependency Management</h3><p>If you are using single module architecture in your project, there’s no problem. But multi-module Android projects are the primary way to develop an Android App now, and it’s highly recommended to use this way to take advantage of performance improvements with Android Gradle Plugin (AGP) 3+. However, when the module size increases, we encounter a big issue - dependency management in each module.</p>
<span id="more"></span>

<p>Here we are going to introduce some solutions for Gradle dependency management. </p>
<h4 id="Manual-management"><a href="#Manual-management" class="headerlink" title="Manual management"></a>Manual management</h4><p>Not a recommended way to do, you might see there are many duplicated dependency code in different modules, for example: </p>
<p><strong>Module_A&#x2F;build.gradle</strong></p>
<pre><code class="highlight script">implementation &quot;com.android.support:support-annotations:27.0.2&quot;
implementation &quot;com.android.support:appcompat-v7:27.0.2&quot;
implementation &quot;com.squareup.retrofit2:retrofit:2.3.0&quot;
implementation &quot;com.squareup.retrofit2:adapter-rxjava2:2.3.0&quot;
implementation &quot;io.reactivex.rxjava2:rxjava:2.1.9&quot;</code></pre>


<p><strong>Module_B&#x2F;build.gradle</strong></p>
<pre><code class="highlight script">implementation &quot;com.android.support:support-annotations:27.0.2&quot;
implementation &quot;com.android.support:appcompat-v7:27.0.2&quot;
implementation &quot;com.squareup.retrofit2:retrofit:2.3.0&quot;
implementation &quot;com.squareup.retrofit2:adapter-rxjava2:2.3.0&quot;
implementation &quot;io.reactivex.rxjava2:rxjava:2.1.9&quot;</code></pre>

<p>This is not a good way and is painful. You will need to dive into different modules and copy-paste almost the same dependencies for each module. </p>
<h4 id="Google-Ext-Section"><a href="#Google-Ext-Section" class="headerlink" title="Google Ext Section"></a>Google Ext Section</h4><p>This is the way recommended by <a href="!https://developer.android.com/studio/build/gradle-tips#configure-project-wide-properties">Google</a>. First of all, we need to define a project-level build.gradle and put the version and library information inside. </p>
<p><strong>Project-level build.Gradle</strong></p>
<pre><code class="highlight script">buildscript &#123;...&#125;
allprojects &#123;...&#125;  
  
// The following are only a few examples of the types of properties you can define.  
extra[&quot;sdkVersion&quot;] = 28  
extra[&quot;supportLibVersion&quot;] = &quot;28.0.0&quot;  
  
...</code></pre>

<p>After that, we need to define the module-level build.gradle file, </p>
<pre><code class="highlight script">android &#123;  
// Use the following syntax to access properties you define at the project level:  // rootProject.ext.property_name  
  val sdkVersion: Int by rootProject.extra  
  compileSdkVersion(sdkVersion)  
  ...  
&#125; 

...

dependencies &#123; 
	implementation(&quot;com.android.support:appcompat-v7:$&#123;rootProject.extra[&quot;supportLibVersion&quot;]&#125;&quot;)  ...  
&#125;</code></pre>

<p>By using this way, it’s very convenient to manage all dependencies in a single file. That’s a considerable improvement. </p>
<h4 id="Kotlin-buildSrc"><a href="#Kotlin-buildSrc" class="headerlink" title="Kotlin buildSrc"></a>Kotlin buildSrc</h4><p>When I was at Cruse, we switched our dependency management to this way. You need to create a <code>buildSrc</code> module with Kotlin code to manage dependencies. The most significant benefit you can gain is leveraging the IDE completion support when importing a dependency. </p>
<p>So, here are steps to use this way. </p>
<ol>
<li><p>Create a <code>buildSrc</code> module </p>
</li>
<li><p>Create <code>build.gradle.kts</code> file to enable this feature. </p>
 <pre><code class="highlight script">plugins &#123;
    `kotlin-dsl`
&#125;</code></pre>
</li>
<li><p>Create your dependency file, for example, ProjectDependency.kt</p>
</li>
</ol>
<pre><code class="highlight kotlin"><span class="keyword">object</span> Versions &#123;
    <span class="keyword">val</span> retrofit = <span class="string">&quot;x.y.z&quot;</span>
&#125;

<span class="keyword">object</span> Libs &#123;
	<span class="keyword">val</span> retrofit = <span class="string">&quot;com.squareup.retrofit2:retrofit:<span class="subst">$&#123;Versions.retrofit&#125;</span>&quot;</span>
&#125;</code></pre>

<p>After creating those files, we can start using those defined dependencies in our module-level build.gradle files. </p>
<h4 id="Gradle-Version-Catalog"><a href="#Gradle-Version-Catalog" class="headerlink" title="Gradle Version Catalog"></a>Gradle Version Catalog</h4><p>Based on the Gradle <a href="!https://docs.gradle.org/current/userguide/platforms.html">document</a>, central declaration of dependencies is an incubating feature. It requires the activation of the <code>VERSION_CATALOGS</code> : </p>
<pre><code class="highlight script">enableFeaturePreview(&#x27;VERSION_CATALOGS&#x27;)</code></pre>

<p>Here is an example to show how to define your version catalog: </p>
<p><strong>settings.gradle.kts</strong></p>
<pre><code class="highlight Kotlin">dependencyResolutionManagement &#123;
	versionCatalogs &#123;
		create(<span class="string">&quot;libs&quot;</span>) &#123;
			alias(<span class="string">&quot;groovy-core&quot;</span>).to(<span class="string">&quot;org.codehaus.groovy:groovy:3.0.5&quot;</span>)
			alias(<span class="string">&quot;groovy-json&quot;</span>).to(<span class="string">&quot;org.codehaus.groovy:groovy-json:3.0.5&quot;</span>)
			alias(<span class="string">&quot;groovy-nio&quot;</span>).to(<span class="string">&quot;org.codehaus.groovy:groovy-nio:3.0.5&quot;</span>)
			alias(<span class="string">&quot;commons-lang3&quot;</span>).to(<span class="string">&quot;org.apache.commons&quot;</span>, <span class="string">&quot;commons-lang3&quot;</span>).version &#123;
				strictly(<span class="string">&quot;[3.8, 4.0[&quot;</span>)
				prefer(<span class="string">&quot;3.9&quot;</span>)
			&#125;
		&#125;
	&#125;
&#125;</code></pre>

<p>Based on this example, you can find the rules as following: </p>
<pre><code class="highlight kotlin">dependencyResolutionManagement &#123;  
	versionCatalogs &#123;  
		create(<span class="string">&quot;libs&quot;</span>) &#123;  
			version(<span class="string">&#x27;version name&#x27;</span>, <span class="string">&#x27;version code&#x27;</span>)  
			alias(<span class="string">&#x27;alias-sample&#x27;</span>).to(<span class="string">&#x27;group&#x27;</span>, <span class="string">&#x27;artifact&#x27;</span>).versionRef(<span class="string">&#x27;version name&#x27;</span>)  
			alias(<span class="string">&#x27;alias.sample&#x27;</span>).to(<span class="string">&#x27;group&#x27;</span>, <span class="string">&#x27;artifact&#x27;</span>).versionRef(<span class="string">&#x27;version name&#x27;</span>)  
			bundle(<span class="string">&#x27;bundle-set&#x27;</span>, [<span class="string">&#x27;alias-sample&#x27;</span>, <span class="string">&#x27;alias.sample&#x27;</span>])  
		&#125;  
	&#125;  
&#125;</code></pre>

<p>It enables you to define your alias and bundle at the top level. You can use them in different modules like, <code>libs.alias.sample</code> or <code>bundle.bundle.set</code> . Version catalogs support autocompletion in the IDE through their type-safe accessors generated by Gradle.</p>
<p>Gradle also supports TOML for the version catalog feature. You would need to create a file called <code>libs.versions.toml</code> in the <code>gradle</code> subdirectory of the root build, then a catalog will be automatically declared with the contents of this file. The <a href="https://toml.io/">TOML</a> file consists of 4 major sections:</p>
<ul>
<li>the <code>[versions]</code> section is used to declare versions that dependencies can reference</li>
<li>the <code>[libraries]</code> section is used to declare the aliases to coordinates</li>
<li>the <code>[bundles]</code> section is used to declare dependency bundles</li>
<li>the <code>[plugins]</code> section is used to declare plugins</li>
</ul>
<p>Here is an example for this file: </p>
<pre><code class="highlight script">[versions]
groovy = &quot;3.0.5&quot;
checkstyle = &quot;8.37&quot;

[libraries]
groovy-core = &#123; module = &quot;org.codehaus.groovy:groovy&quot;, version.ref = &quot;groovy&quot; &#125;
groovy-json = &#123; module = &quot;org.codehaus.groovy:groovy-json&quot;, version.ref = &quot;groovy&quot; &#125;
groovy-nio = &#123; module = &quot;org.codehaus.groovy:groovy-nio&quot;, version.ref = &quot;groovy&quot; &#125;
commons-lang3 = &#123; group = &quot;org.apache.commons&quot;, name = &quot;commons-lang3&quot;, version = &#123; strictly = &quot;[3.8, 4.0[&quot;, prefer=&quot;3.9&quot; &#125; &#125;

[bundles]
groovy = [&quot;groovy-core&quot;, &quot;groovy-json&quot;, &quot;groovy-nio&quot;]

[plugins]
jmh = &#123; id = &quot;me.champeau.jmh&quot;, version = &quot;0.6.5&quot; &#125;</code></pre>

<p>The usage is very similar when you define those parameters in your gradle files. For example, </p>
<pre><code class="highlight script">// access version section 
buildscript &#123;
	dependencies &#123;
		classpath &quot;lib.x.y.z:$&#123;libs.versions.groovy.get()&#125;&quot;  
	&#125;
&#125;

// access a single dependency
implementation libs.groovy.core

// access a bundle 
implementation libs.bundles.groovy</code></pre>

<p>That’s it. Enjoy the coding. </p>
<p>#Android #Android&#x2F;Gradle&#x2F;VersionCatalog </p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Gradle-Dependency/" rel="tag"># Gradle Dependency</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/01/13/Setup-Gerrit-Server-for-AOSP/" rel="prev" title="Setup Gerrit Server for AOSP">
      <i class="fa fa-chevron-left"></i> Setup Gerrit Server for AOSP
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/01/23/Import-Android-Framework-Jar/" rel="next" title="Import Android Framework Jar">
      Import Android Framework Jar <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/01/17/Gradle-dependency-management/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chauyan">
      <meta itemprop="description" content="Personal dev blog for sharing what I've learned.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="舊金山周記">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Gradle dependency management
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-01-17 08:12:35" itemprop="dateCreated datePublished" datetime="2022-01-17T08:12:35-08:00">2022-01-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-01-18 18:56:12" itemprop="dateModified" datetime="2022-01-18T18:56:12-08:00">2022-01-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android-Dev/" itemprop="url" rel="index"><span itemprop="name">Android Dev</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2022/01/17/Gradle-dependency-management/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2022/01/17/Gradle-dependency-management/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><img src="https://upload.wikimedia.org/wikipedia/commons/c/cb/Gradle_logo.png" alt="gradle logo"></p>
<h3 id="Gradle-Dependency-Management"><a href="#Gradle-Dependency-Management" class="headerlink" title="Gradle Dependency Management"></a>Gradle Dependency Management</h3><p>If you are using single module architecture in your project, there’s no problem. But multi-module Android projects are the primary way to develop an Android App now, and it’s highly recommended to use this way to take advantage of performance improvements with Android Gradle Plugin (AGP) 3+. However, when the module size increases, we encounter a big issue - dependency management in each module.</p>
<span id="more"></span>

<p>Here we are going to introduce some solutions for Gradle dependency management. </p>
<h4 id="Manual-management"><a href="#Manual-management" class="headerlink" title="Manual management"></a>Manual management</h4><p>Not a recommended way to do, you might see there are many duplicated dependency code in different modules, for example: </p>
<p><strong>Module_A&#x2F;build.gradle</strong></p>
<pre><code class="highlight script">implementation &quot;com.android.support:support-annotations:27.0.2&quot;
implementation &quot;com.android.support:appcompat-v7:27.0.2&quot;
implementation &quot;com.squareup.retrofit2:retrofit:2.3.0&quot;
implementation &quot;com.squareup.retrofit2:adapter-rxjava2:2.3.0&quot;
implementation &quot;io.reactivex.rxjava2:rxjava:2.1.9&quot;</code></pre>


<p><strong>Module_B&#x2F;build.gradle</strong></p>
<pre><code class="highlight script">implementation &quot;com.android.support:support-annotations:27.0.2&quot;
implementation &quot;com.android.support:appcompat-v7:27.0.2&quot;
implementation &quot;com.squareup.retrofit2:retrofit:2.3.0&quot;
implementation &quot;com.squareup.retrofit2:adapter-rxjava2:2.3.0&quot;
implementation &quot;io.reactivex.rxjava2:rxjava:2.1.9&quot;</code></pre>

<p>This is not a good way and is painful. You will need to dive into different modules and copy-paste almost the same dependencies for each module. </p>
<h4 id="Google-Ext-Section"><a href="#Google-Ext-Section" class="headerlink" title="Google Ext Section"></a>Google Ext Section</h4><p>This is the way recommended by <a href="!https://developer.android.com/studio/build/gradle-tips#configure-project-wide-properties">Google</a>. First of all, we need to define a project-level build.gradle and put the version and library information inside. </p>
<p><strong>Project-level build.Gradle</strong></p>
<pre><code class="highlight script">buildscript &#123;...&#125;
allprojects &#123;...&#125;  
  
// The following are only a few examples of the types of properties you can define.  
extra[&quot;sdkVersion&quot;] = 28  
extra[&quot;supportLibVersion&quot;] = &quot;28.0.0&quot;  
  
...</code></pre>

<p>After that, we need to define the module-level build.gradle file, </p>
<pre><code class="highlight script">android &#123;  
// Use the following syntax to access properties you define at the project level:  // rootProject.ext.property_name  
  val sdkVersion: Int by rootProject.extra  
  compileSdkVersion(sdkVersion)  
  ...  
&#125; 

...

dependencies &#123; 
	implementation(&quot;com.android.support:appcompat-v7:$&#123;rootProject.extra[&quot;supportLibVersion&quot;]&#125;&quot;)  ...  
&#125;</code></pre>

<p>By using this way, it’s very convenient to manage all dependencies in a single file. That’s a considerable improvement. </p>
<h4 id="Kotlin-buildSrc"><a href="#Kotlin-buildSrc" class="headerlink" title="Kotlin buildSrc"></a>Kotlin buildSrc</h4><p>When I was at Cruse, we switched our dependency management to this way. You need to create a <code>buildSrc</code> module with Kotlin code to manage dependencies. The most significant benefit you can gain is leveraging the IDE completion support when importing a dependency. </p>
<p>So, here are steps to use this way. </p>
<ol>
<li><p>Create a <code>buildSrc</code> module </p>
</li>
<li><p>Create <code>build.gradle.kts</code> file to enable this feature. </p>
 <pre><code class="highlight script">plugins &#123;
    `kotlin-dsl`
&#125;</code></pre>
</li>
<li><p>Create your dependency file, for example, ProjectDependency.kt</p>
</li>
</ol>
<pre><code class="highlight kotlin"><span class="keyword">object</span> Versions &#123;
    <span class="keyword">val</span> retrofit = <span class="string">&quot;x.y.z&quot;</span>
&#125;

<span class="keyword">object</span> Libs &#123;
	<span class="keyword">val</span> retrofit = <span class="string">&quot;com.squareup.retrofit2:retrofit:<span class="subst">$&#123;Versions.retrofit&#125;</span>&quot;</span>
&#125;</code></pre>

<p>After creating those files, we can start using those defined dependencies in our module-level build.gradle files. </p>
<h4 id="Gradle-Version-Catalog"><a href="#Gradle-Version-Catalog" class="headerlink" title="Gradle Version Catalog"></a>Gradle Version Catalog</h4><p>Based on the Gradle <a href="!https://docs.gradle.org/current/userguide/platforms.html">document</a>, central declaration of dependencies is an incubating feature. It requires the activation of the <code>VERSION_CATALOGS</code> : </p>
<pre><code class="highlight script">enableFeaturePreview(&#x27;VERSION_CATALOGS&#x27;)</code></pre>

<p>Here is an example to show how to define your version catalog: </p>
<p><strong>settings.gradle.kts</strong></p>
<pre><code class="highlight Kotlin">dependencyResolutionManagement &#123;
	versionCatalogs &#123;
		create(<span class="string">&quot;libs&quot;</span>) &#123;
			alias(<span class="string">&quot;groovy-core&quot;</span>).to(<span class="string">&quot;org.codehaus.groovy:groovy:3.0.5&quot;</span>)
			alias(<span class="string">&quot;groovy-json&quot;</span>).to(<span class="string">&quot;org.codehaus.groovy:groovy-json:3.0.5&quot;</span>)
			alias(<span class="string">&quot;groovy-nio&quot;</span>).to(<span class="string">&quot;org.codehaus.groovy:groovy-nio:3.0.5&quot;</span>)
			alias(<span class="string">&quot;commons-lang3&quot;</span>).to(<span class="string">&quot;org.apache.commons&quot;</span>, <span class="string">&quot;commons-lang3&quot;</span>).version &#123;
				strictly(<span class="string">&quot;[3.8, 4.0[&quot;</span>)
				prefer(<span class="string">&quot;3.9&quot;</span>)
			&#125;
		&#125;
	&#125;
&#125;</code></pre>

<p>Based on this example, you can find the rules as following: </p>
<pre><code class="highlight kotlin">dependencyResolutionManagement &#123;  
	versionCatalogs &#123;  
		create(<span class="string">&quot;libs&quot;</span>) &#123;  
			version(<span class="string">&#x27;version name&#x27;</span>, <span class="string">&#x27;version code&#x27;</span>)  
			alias(<span class="string">&#x27;alias-sample&#x27;</span>).to(<span class="string">&#x27;group&#x27;</span>, <span class="string">&#x27;artifact&#x27;</span>).versionRef(<span class="string">&#x27;version name&#x27;</span>)  
			alias(<span class="string">&#x27;alias.sample&#x27;</span>).to(<span class="string">&#x27;group&#x27;</span>, <span class="string">&#x27;artifact&#x27;</span>).versionRef(<span class="string">&#x27;version name&#x27;</span>)  
			bundle(<span class="string">&#x27;bundle-set&#x27;</span>, [<span class="string">&#x27;alias-sample&#x27;</span>, <span class="string">&#x27;alias.sample&#x27;</span>])  
		&#125;  
	&#125;  
&#125;</code></pre>

<p>It enables you to define your alias and bundle at the top level. You can use them in different modules like, <code>libs.alias.sample</code> or <code>bundle.bundle.set</code> . Version catalogs support autocompletion in the IDE through their type-safe accessors generated by Gradle.</p>
<p>Gradle also supports TOML for the version catalog feature. You would need to create a file called <code>libs.versions.toml</code> in the <code>gradle</code> subdirectory of the root build, then a catalog will be automatically declared with the contents of this file. The <a href="https://toml.io/">TOML</a> file consists of 4 major sections:</p>
<ul>
<li>the <code>[versions]</code> section is used to declare versions that dependencies can reference</li>
<li>the <code>[libraries]</code> section is used to declare the aliases to coordinates</li>
<li>the <code>[bundles]</code> section is used to declare dependency bundles</li>
<li>the <code>[plugins]</code> section is used to declare plugins</li>
</ul>
<p>Here is an example for this file: </p>
<pre><code class="highlight script">[versions]
groovy = &quot;3.0.5&quot;
checkstyle = &quot;8.37&quot;

[libraries]
groovy-core = &#123; module = &quot;org.codehaus.groovy:groovy&quot;, version.ref = &quot;groovy&quot; &#125;
groovy-json = &#123; module = &quot;org.codehaus.groovy:groovy-json&quot;, version.ref = &quot;groovy&quot; &#125;
groovy-nio = &#123; module = &quot;org.codehaus.groovy:groovy-nio&quot;, version.ref = &quot;groovy&quot; &#125;
commons-lang3 = &#123; group = &quot;org.apache.commons&quot;, name = &quot;commons-lang3&quot;, version = &#123; strictly = &quot;[3.8, 4.0[&quot;, prefer=&quot;3.9&quot; &#125; &#125;

[bundles]
groovy = [&quot;groovy-core&quot;, &quot;groovy-json&quot;, &quot;groovy-nio&quot;]

[plugins]
jmh = &#123; id = &quot;me.champeau.jmh&quot;, version = &quot;0.6.5&quot; &#125;</code></pre>

<p>The usage is very similar when you define those parameters in your gradle files. For example, </p>
<pre><code class="highlight script">// access version section 
buildscript &#123;
	dependencies &#123;
		classpath &quot;lib.x.y.z:$&#123;libs.versions.groovy.get()&#125;&quot;  
	&#125;
&#125;

// access a single dependency
implementation libs.groovy.core

// access a bundle 
implementation libs.bundles.groovy</code></pre>

<p>That’s it. Enjoy the coding. </p>
<p>#Android #Android&#x2F;Gradle&#x2F;VersionCatalog </p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Gradle-Dependency/" rel="tag"># Gradle Dependency</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/01/13/Setup-Gerrit-Server-for-AOSP/" rel="prev" title="Setup Gerrit Server for AOSP">
      <i class="fa fa-chevron-left"></i> Setup Gerrit Server for AOSP
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/01/23/Import-Android-Framework-Jar/" rel="next" title="Import Android Framework Jar">
      Import Android Framework Jar <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>
  <div>
  <script type="text/javascript">
	atOptions = {
		'key' : '335b6d5fd0ce419dba15708955862700',
		'format' : 'iframe',
		'height' : 60,
		'width' : 468,
		'params' : {}
	};
	document.write('<scr' + 'ipt type="text/javascript" src="http' + (location.protocol === 'https:' ? 's' : '') + '://www.madcpms.com/335b6d5fd0ce419dba15708955862700/invoke.js"></scr' + 'ipt>');
</script>
  </div>


          </div>
          
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Gradle-Dependency-Management"><span class="nav-number">1.</span> <span class="nav-text">Gradle Dependency Management</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Manual-management"><span class="nav-number">1.1.</span> <span class="nav-text">Manual management</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Google-Ext-Section"><span class="nav-number">1.2.</span> <span class="nav-text">Google Ext Section</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Kotlin-buildSrc"><span class="nav-number">1.3.</span> <span class="nav-text">Kotlin buildSrc</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Gradle-Version-Catalog"><span class="nav-number">1.4.</span> <span class="nav-text">Gradle Version Catalog</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Chauyan</p>
  <div class="site-description" itemprop="description">Personal dev blog for sharing what I've learned.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">67</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">102</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/wangchauyan" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;wangchauyan" rel="noopener" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:wang.chauyan@gmail.com" title="E-Mail → mailto:wang.chauyan@gmail.com" rel="noopener" target="_blank"><i class="envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/deathrid" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;deathrid" rel="noopener" target="_blank"><i class="twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.facebook.com/chauyanw/" title="FB Page → https:&#x2F;&#x2F;www.facebook.com&#x2F;chauyanw&#x2F;" rel="noopener" target="_blank"><i class="facebook fa-fw"></i>FB Page</a>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Chauyan</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://chauyan.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "http://yoursite.com/2022/01/17/Gradle-dependency-management/";
    this.page.identifier = "2022/01/17/Gradle-dependency-management/";
    this.page.title = "Gradle dependency management";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://chauyan.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

  <!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/7.2.0/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/7.2.0/firebase-analytics.js"></script>

<script>
  // Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyCqTNIS0PZUFVzFmQOCcFEheWocG9daymY",
    authDomain: "personaldevblog.firebaseapp.com",
    databaseURL: "https://personaldevblog.firebaseio.com",
    projectId: "personaldevblog",
    storageBucket: "personaldevblog.appspot.com",
    messagingSenderId: "785621246959",
    appId: "1:785621246959:web:87cab80109fd2701f44c1a",
    measurementId: "G-4KWYT0P8Z8"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  firebase.analytics();
</script>
</body>
</html>
